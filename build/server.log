--- Début du log : 1746135133 ---
[2025-05-01 23:32:13][DEBUG] TransactionQueue créée.
[2025-05-01 23:32:13][INFO] Main_Serv INFO : Démarrage du programme serveur.
[2025-05-01 23:32:13][ERROR] Main_Serv ERROR : Nombre d'arguments incorrect. Attendu 7, reçu 0.
[2025-05-01 23:32:13][DEBUG] Destructeur TransactionQueue appelé. Arrêt du thread de traitement...
[2025-05-01 23:32:13][WARNING] TransactionQueue::stop Thread de traitement déjà arrêté ou non démarré.
[2025-05-01 23:32:13][DEBUG] Destructeur TransactionQueue terminé.
--- Fin du log : 1746135133 ---
--- Début du log : 1746135346 ---
[2025-05-01 23:35:46][DEBUG] TransactionQueue créée.
[2025-05-01 23:35:46][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-01 23:35:46][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: cert.pem, Key: key.pem, Users: users.txt, Counter: counter.txt, History: history.txt, Wallets Dir: wallets/
[2025-05-01 23:35:46][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-01 23:35:46][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-01 23:35:46][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-01 23:35:46][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-01 23:35:46][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-01 23:35:46][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-01 23:35:46][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-01 23:35:46][ERROR] Server::InitServerCTX ERROR : Échec chargement certificat serveur : cert.pem
[2025-05-01 23:35:46][ERROR] Server::StartServer ERROR : Échec de l'initialisation du contexte SSL serveur. Arrêt.
[2025-05-01 23:35:46][INFO] Main_Serv INFO : Programme serveur terminé normalement.
[2025-05-01 23:35:46][DEBUG] Main_Serv DEBUG : Nettoyage global OpenSSL...
[2025-05-01 23:35:46][DEBUG] Main_Serv DEBUG : Nettoyage global OpenSSL terminé.
[2025-05-01 23:35:46][INFO] Server::~Server INFO : Destructeur appelé. Début de l'arrêt propre...
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Arrêt ordonné du serveur demandé...
[2025-05-01 23:35:46][DEBUG] Server::StopServer DEBUG : acceptingConnections flag positionné à false.
[2025-05-01 23:35:46][DEBUG] Server::StopServer DEBUG : Socket d'écoute déjà fermé (-1).
[2025-05-01 23:35:46][WARNING] Server::StopServer WARNING : Thread d'acceptation non joignable lors de l'arrêt.
[2025-05-01 23:35:46][DEBUG] Server::StopServer DEBUG : Copie de 0 sessions actives pour arrêt.
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Signal d'arrêt envoyé à 0 sessions clientes actives. Attente de leur fin...
[2025-05-01 23:35:46][DEBUG] Server::StopServer DEBUG : Appel stop() terminé pour toutes les sessions copiées.
[2025-05-01 23:35:46][INFO] Server::SaveUsersInternal INFO : Sauvegarde de 0 utilisateurs dans users.txt
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Liste des utilisateurs sauvegardée.
[2025-05-01 23:35:46][INFO] Transaction::saveCounter Compteur sauvegardé: 0 vers counter.txt
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Compteur de transactions sauvegardé.
[2025-05-01 23:35:46][INFO] Global Demande d'arrêt du thread de génération de prix.
[2025-05-01 23:35:46][WARNING] Global Thread de génération de prix non joignable ou déjà terminé lors de la demande d'arrêt.
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Thread de génération des prix arrêté.
[2025-05-01 23:35:46][WARNING] TransactionQueue::stop Thread de traitement déjà arrêté ou non démarré.
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Thread de traitement de la TransactionQueue arrêté.
[2025-05-01 23:35:46][INFO] Server::StopServer INFO : Arrêt ordonné du serveur terminé.
[2025-05-01 23:35:46][INFO] Server::~Server INFO : Destructeur terminé.
[2025-05-01 23:35:46][DEBUG] Destructeur TransactionQueue appelé. Arrêt du thread de traitement...
[2025-05-01 23:35:46][WARNING] TransactionQueue::stop Thread de traitement déjà arrêté ou non démarré.
[2025-05-01 23:35:46][DEBUG] Destructeur TransactionQueue terminé.
--- Fin du log : 1746135346 ---
--- Début du log : 1746136193 ---
[2025-05-01 23:49:53][DEBUG] TransactionQueue créée.
[2025-05-01 23:49:53][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-01 23:49:53][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../cert.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-01 23:49:53][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-01 23:49:53][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-01 23:49:53][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-01 23:49:53][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-01 23:49:53][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-01 23:49:53][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-01 23:49:53][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-01 23:49:53][ERROR] Server::InitServerCTX ERROR : Échec chargement certificat serveur : ../cert.crt
[2025-05-01 23:49:53][ERROR] Server::StartServer ERROR : Échec de l'initialisation du contexte SSL serveur. Arrêt.
[2025-05-01 23:49:53][INFO] Main_Serv INFO : Programme serveur terminé normalement.
[2025-05-01 23:49:53][DEBUG] Main_Serv DEBUG : Nettoyage global OpenSSL...
[2025-05-01 23:49:53][DEBUG] Main_Serv DEBUG : Nettoyage global OpenSSL terminé.
[2025-05-01 23:49:53][INFO] Server::~Server INFO : Destructeur appelé. Début de l'arrêt propre...
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Arrêt ordonné du serveur demandé...
[2025-05-01 23:49:53][DEBUG] Server::StopServer DEBUG : acceptingConnections flag positionné à false.
[2025-05-01 23:49:53][DEBUG] Server::StopServer DEBUG : Socket d'écoute déjà fermé (-1).
[2025-05-01 23:49:53][WARNING] Server::StopServer WARNING : Thread d'acceptation non joignable lors de l'arrêt.
[2025-05-01 23:49:53][DEBUG] Server::StopServer DEBUG : Copie de 0 sessions actives pour arrêt.
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Signal d'arrêt envoyé à 0 sessions clientes actives. Attente de leur fin...
[2025-05-01 23:49:53][DEBUG] Server::StopServer DEBUG : Appel stop() terminé pour toutes les sessions copiées.
[2025-05-01 23:49:53][INFO] Server::SaveUsersInternal INFO : Sauvegarde de 0 utilisateurs dans users.txt
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Liste des utilisateurs sauvegardée.
[2025-05-01 23:49:53][INFO] Transaction::saveCounter Compteur sauvegardé: 0 vers counter.txt
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Compteur de transactions sauvegardé.
[2025-05-01 23:49:53][INFO] Global Demande d'arrêt du thread de génération de prix.
[2025-05-01 23:49:53][WARNING] Global Thread de génération de prix non joignable ou déjà terminé lors de la demande d'arrêt.
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Thread de génération des prix arrêté.
[2025-05-01 23:49:53][WARNING] TransactionQueue::stop Thread de traitement déjà arrêté ou non démarré.
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Thread de traitement de la TransactionQueue arrêté.
[2025-05-01 23:49:53][INFO] Server::StopServer INFO : Arrêt ordonné du serveur terminé.
[2025-05-01 23:49:53][INFO] Server::~Server INFO : Destructeur terminé.
[2025-05-01 23:49:53][DEBUG] Destructeur TransactionQueue appelé. Arrêt du thread de traitement...
[2025-05-01 23:49:53][WARNING] TransactionQueue::stop Thread de traitement déjà arrêté ou non démarré.
[2025-05-01 23:49:53][DEBUG] Destructeur TransactionQueue terminé.
--- Fin du log : 1746136193 ---
--- Début du log : 1746136262 ---
[2025-05-01 23:51:02][DEBUG] TransactionQueue créée.
[2025-05-01 23:51:02][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-01 23:51:02][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-01 23:51:02][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-01 23:51:02][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-01 23:51:02][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-01 23:51:02][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-01 23:51:02][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-01 23:51:02][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-01 23:51:02][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-01 23:51:02][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-01 23:51:02][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-01 23:51:02][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 0 entrées chargées depuis users.txt
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-01 23:51:02][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-01 23:51:02][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-01 23:51:02][INFO] Global Thread de génération de prix initié.
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-01 23:51:02][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-01 23:51:02][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-01 23:51:02][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-01 23:51:02][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-01 23:51:02][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-01 23:51:02][INFO] Global Thread de génération de prix démarré.
[2025-05-01 23:51:02][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-01 23:51:02][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-01 23:51:02][INFO] Global Nouveau prix SRD-BTC simulé : 96648.4164046483
[2025-05-01 23:51:18][INFO] Global Nouveau prix SRD-BTC simulé : 96161.5515805778
[2025-05-01 23:51:33][INFO] Global Nouveau prix SRD-BTC simulé : 98017.5407404625
[2025-05-01 23:51:48][INFO] Global Nouveau prix SRD-BTC simulé : 98300.5953645451
[2025-05-01 23:51:54][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-01 23:51:54][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-01 23:51:54][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-01 23:51:54][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-01 23:51:54][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-01 23:51:54][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-01 23:51:54][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-01 23:51:54][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-01 23:51:54][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-01 23:51:54][DEBUG] Server::HandleClient DEBUG : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-01 23:51:54][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-01 23:51:54][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-01 23:51:54][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:mon_client_id_depuis_script,TOKEN:mon_token_depuis_script
'
[2025-05-01 23:51:54][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'mon_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-01 23:51:54][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'mon_client_id_depuis_script'...
[2025-05-01 23:51:54][DEBUG] Server::processAuthRequest DEBUG : ID non trouvé : 'mon_client_id_depuis_script'. Tentative d'enregistrement...
[2025-05-01 23:51:54][WARNING] SecurityUtils WARNING : HashPasswordSecure est un placeholder. REMPLACER PAR UN VRAI HACHAGE SECURISÉ (bcrypt, Argon2) !
[2025-05-01 23:51:54][DEBUG] Server::processAuthRequest DEBUG : Nouvel utilisateur 'mon_client_id_depuis_script' ajouté à map en mémoire.
[2025-05-01 23:51:54][INFO] Server::SaveUsersInternal INFO : Sauvegarde de 1 utilisateurs dans users.txt
[2025-05-01 23:51:54][INFO] Server::processAuthRequest INFO : Liste utilisateurs sauvegardée sur disque après ajout ID: 'mon_client_id_depuis_script'.
[2025-05-01 23:51:54][DEBUG] Server::CreateWalletFile DEBUG : Tentative création fichier portefeuille: wallets//mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][DEBUG] Server::CreateWalletFile DEBUG : Répertoire portefeuilles vérifié/créé : wallets/
[2025-05-01 23:51:54][DEBUG] Server::CreateWalletFile DEBUG : Fichier portefeuille ouvert/créé : wallets//mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Server::CreateWalletFile INFO : Fichier portefeuille vierge créé et initialisé : wallets//mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Server::processAuthRequest INFO : Fichier portefeuille créé avec succès pour ID: 'mon_client_id_depuis_script'.
[2025-05-01 23:51:54][INFO] Server::processAuthRequest INFO : Enregistrement nouvel utilisateur 'mon_client_id_depuis_script' réussi.
[2025-05-01 23:51:54][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification/enregistrement réussi pour ID: 'mon_client_id_depuis_script'. Résultat Server: NEW. Token de session généré. Socket FD: 6
[2025-05-01 23:51:54][DEBUG] Server::HandleClient DEBUG : Client ID authentifié: 'mon_client_id_depuis_script' (NEW). Socket FD: 6
[2025-05-01 23:51:54][INFO] ClientSession
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire : wallets
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 2, strerror(errno) : 'No such file or directory'
[2025-05-01 23:51:54][WARNING] Wallet Avertissement: create_directories retour false pour wallets mais ec vide. Comportement inhabituel, traité comme succès pour l'existence.
[2025-05-01 23:51:54][DEBUG] Wallet Lecture du fichier portefeuille : wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Wallet Portefeuille (mon_client_id_depuis_script) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-01 23:51:54][INFO] Wallet Portefeuille chargé avec succès pour client ID: mon_client_id_depuis_script depuis wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][DEBUG] Wallet Objet Wallet créé pour client ID: mon_client_id_depuis_script. Chemin du fichier: wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire : wallets
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 2, strerror(errno) : 'No such file or directory'
[2025-05-01 23:51:54][WARNING] Wallet Avertissement: create_directories retour false pour wallets mais ec vide. Comportement inhabituel, traité comme succès pour l'existence.
[2025-05-01 23:51:54][DEBUG] Wallet Lecture du fichier portefeuille : wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Wallet Portefeuille (mon_client_id_depuis_script) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-01 23:51:54][INFO] ClientSession
[2025-05-01 23:51:54][ERROR] Server::HandleClient ERROR : Impossible créer/initialiser ClientSession ou Wallet pour client ID: mon_client_id_depuis_script. Socket FD: 6. Arrêt du thread.
[2025-05-01 23:51:54][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 6
[2025-05-01 23:51:54][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-01 23:51:54][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-01 23:51:54][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-01 23:51:54][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 6
[2025-05-01 23:51:54][INFO] ServerConnection::closeConnection INFO : Socket FD: 6 fermé.
[2025-05-01 23:51:54][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-01 23:51:54][INFO] ClientSession
[2025-05-01 23:51:54][INFO] ClientSession
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire : wallets
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-01 23:51:54][WARNING] Wallet Avertissement: create_directories retour false pour wallets mais ec vide. Comportement inhabituel, traité comme succès pour l'existence.
[2025-05-01 23:51:54][DEBUG] Wallet Sauvegarde du portefeuille : wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Wallet Portefeuille (mon_client_id_depuis_script) sauvegardé : USD=10000.0000000000, SRD-BTC=0.0000000000.
[2025-05-01 23:51:54][INFO] ClientSession
[2025-05-01 23:51:54][DEBUG] Wallet Objet Wallet détruit pour client ID: mon_client_id_depuis_script. Sauvegarde finale en cours...
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire : wallets
[2025-05-01 23:51:54][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-01 23:51:54][WARNING] Wallet Avertissement: create_directories retour false pour wallets mais ec vide. Comportement inhabituel, traité comme succès pour l'existence.
[2025-05-01 23:51:54][DEBUG] Wallet Sauvegarde du portefeuille : wallets/mon_client_id_depuis_script.wallet
[2025-05-01 23:51:54][INFO] Wallet Portefeuille (mon_client_id_depuis_script) sauvegardé : USD=10000.0000000000, SRD-BTC=0.0000000000.
[2025-05-01 23:51:54][INFO] Wallet Portefeuille pour client ID: mon_client_id_depuis_script sauvegardé avec succès vers wallets/mon_client_id_depuis_script.wallet avant destruction.
[2025-05-01 23:51:54][DEBUG] Wallet Objet Wallet détruit pour client ID: mon_client_id_depuis_script. Sauvegarde finale terminée.
[2025-05-01 23:51:54][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-01 23:51:54][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
--- Début du log : 1746136844 ---
[2025-05-02 00:00:44][DEBUG] TransactionQueue créée.
[2025-05-02 00:00:44][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 00:00:44][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 00:00:44][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 00:00:44][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 00:00:44][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 00:00:44][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 00:00:44][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 00:00:44][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 00:00:44][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 00:00:44][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 00:00:44][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:00:44][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 1 entrées chargées depuis users.txt
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 00:00:44][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 00:00:44][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 00:00:44][INFO] Global Thread de génération de prix initié.
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 00:00:44][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 00:00:44][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 00:00:44][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 00:00:44][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 00:00:44][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 00:00:44][INFO] Global Thread de génération de prix démarré.
[2025-05-02 00:00:44][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 00:00:44][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 00:00:44][INFO] Global Nouveau prix SRD-BTC simulé : 96549.5645330726
[2025-05-02 00:00:51][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 00:00:51][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 00:00:51][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:00:51][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 00:00:51][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 00:00:51][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 00:00:51][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 00:00:51][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 00:00:51][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 00:00:51][DEBUG] Server::HandleClient DEBUG : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 00:00:51][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 00:00:51][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 00:00:51][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:mon_client_id_depuis_script,TOKEN:mon_token_depuis_script
'
[2025-05-02 00:00:51][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'mon_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 00:00:51][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'mon_client_id_depuis_script'...
[2025-05-02 00:00:51][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'mon_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 00:00:51][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 00:00:51][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'mon_client_id_depuis_script'.
[2025-05-02 00:00:51][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification/enregistrement réussi pour ID: 'mon_client_id_depuis_script'. Résultat Server: SUCCESS. Token de session généré. Socket FD: 6
[2025-05-02 00:00:51][DEBUG] Server::HandleClient DEBUG : Client ID authentifié: 'mon_client_id_depuis_script' (SUCCESS). Socket FD: 6
[2025-05-02 00:00:51][INFO] ClientSession
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:00:51][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:00:51][WARNING] Wallet Impossible de charger le portefeuille pour client ID: mon_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:00:51][DEBUG] Wallet Objet Wallet créé pour client ID: mon_client_id_depuis_script. Chemin du fichier: wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:00:51][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:00:51][INFO] ClientSession
[2025-05-02 00:00:51][ERROR] Server::HandleClient ERROR : Impossible créer/initialiser ClientSession ou Wallet pour client ID: mon_client_id_depuis_script. Socket FD: 6. Arrêt du thread.
[2025-05-02 00:00:51][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 6
[2025-05-02 00:00:51][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 00:00:51][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 00:00:51][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 00:00:51][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 6
[2025-05-02 00:00:51][INFO] ServerConnection::closeConnection INFO : Socket FD: 6 fermé.
[2025-05-02 00:00:51][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 00:00:51][INFO] ClientSession
[2025-05-02 00:00:51][INFO] ClientSession
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:00:51][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:00:51][INFO] ClientSession
[2025-05-02 00:00:51][DEBUG] Wallet Objet Wallet détruit pour client ID: mon_client_id_depuis_script. Sauvegarde finale en cours...
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:00:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:00:51][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:00:51][ERROR] Wallet Échec de la sauvegarde finale du portefeuille pour client ID: mon_client_id_depuis_script vers wallets/mon_client_id_depuis_script.wallet.
[2025-05-02 00:00:51][DEBUG] Wallet Objet Wallet détruit pour client ID: mon_client_id_depuis_script. Sauvegarde finale terminée.
[2025-05-02 00:00:51][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 00:00:51][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
--- Début du log : 1746137806 ---
[2025-05-02 00:16:46][DEBUG] TransactionQueue créée.
[2025-05-02 00:16:46][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 00:16:46][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 00:16:46][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 00:16:46][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 00:16:46][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 00:16:46][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 00:16:46][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 00:16:46][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 00:16:46][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 00:16:46][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 00:16:46][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:16:46][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 1 entrées chargées depuis users.txt
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 00:16:46][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 00:16:46][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 00:16:46][INFO] Global Thread de génération de prix initié.
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 00:16:46][INFO] Global Thread de génération de prix démarré.
[2025-05-02 00:16:46][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 00:16:46][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 00:16:46][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 00:16:46][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 5
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 00:16:46][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 00:16:46][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 00:16:46][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 00:16:46][INFO] Global Nouveau prix SRD-BTC simulé : 94227.2784703450
[2025-05-02 00:16:51][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 11, IP: 10.188.240.101
[2025-05-02 00:16:51][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 11
[2025-05-02 00:16:51][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 11
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:16:51][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:16:51][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 00:16:51][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 00:16:51][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 00:16:51][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 11
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 11
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 11
[2025-05-02 00:16:51][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (11) et SSL existants.
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 11
[2025-05-02 00:16:51][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 00:16:51][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 11
[2025-05-02 00:16:51][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 11 : 'ID:mon_client_id_depuis_script,TOKEN:mon_token_depuis_script
'
[2025-05-02 00:16:51][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'mon_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 11
[2025-05-02 00:16:51][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'mon_client_id_depuis_script'...
[2025-05-02 00:16:51][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'mon_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 00:16:51][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 00:16:51][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'mon_client_id_depuis_script'.
[2025-05-02 00:16:51][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification/enregistrement réussi pour ID: 'mon_client_id_depuis_script'. Résultat Server: SUCCESS. Token de session généré. Socket FD: 11
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'mon_client_id_depuis_script' (SUCCESS). Socket FD: 11
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: mon_client_id_depuis_script...
[2025-05-02 00:16:51][INFO] ClientSession INFO : Initialisation pour client mon_client_id_depuis_script
[2025-05-02 00:16:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:16:51][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:16:51][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:16:51][WARNING] Wallet Impossible de charger le portefeuille pour client ID: mon_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:16:51][DEBUG] Wallet Objet Wallet créé pour client ID: mon_client_id_depuis_script. Chemin du fichier: wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'mon_client_id_depuis_script'. Socket FD: 11
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: mon_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 00:16:51][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : ClientSession pour client ID: mon_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 00:16:51][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 00:16:51][INFO] ClientSession
[2025-05-02 00:16:51][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:16:51][INFO] ClientSession
[2025-05-02 00:16:51][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: mon_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 00:16:51][INFO] ClientSession
[2025-05-02 00:17:01][INFO] Global Nouveau prix SRD-BTC simulé : 97433.6425022957
--- Début du log : 1746138003 ---
[2025-05-02 00:20:03][DEBUG] TransactionQueue créée.
[2025-05-02 00:20:03][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 00:20:03][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 00:20:03][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 00:20:03][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 00:20:03][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 00:20:03][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 00:20:03][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 00:20:03][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 00:20:03][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 00:20:03][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 00:20:03][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:20:03][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 1 entrées chargées depuis users.txt
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 00:20:03][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 00:20:03][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 00:20:03][INFO] Global Thread de génération de prix initié.
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 00:20:03][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 00:20:03][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 00:20:03][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 00:20:03][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 00:20:03][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 00:20:03][INFO] Global Thread de génération de prix démarré.
[2025-05-02 00:20:03][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 00:20:03][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 00:20:03][INFO] Global Nouveau prix SRD-BTC simulé : 96088.5156968244
[2025-05-02 00:20:07][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 5, IP: 10.188.240.101
[2025-05-02 00:20:07][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 5
[2025-05-02 00:20:07][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 5
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:20:07][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:20:07][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 00:20:07][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 00:20:07][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 00:20:07][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 5
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 5
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 5
[2025-05-02 00:20:07][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (5) et SSL existants.
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 5
[2025-05-02 00:20:07][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 00:20:07][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 5
[2025-05-02 00:20:07][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 5 : 'ID:mon_client_id_depuis_script,TOKEN:mon_token_depuis_script
'
[2025-05-02 00:20:07][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'mon_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 5
[2025-05-02 00:20:07][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'mon_client_id_depuis_script'...
[2025-05-02 00:20:07][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'mon_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 00:20:07][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 00:20:07][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'mon_client_id_depuis_script'.
[2025-05-02 00:20:07][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification/enregistrement réussi pour ID: 'mon_client_id_depuis_script'. Résultat Server: SUCCESS. Token de session généré. Socket FD: 5
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'mon_client_id_depuis_script' (SUCCESS). Socket FD: 5
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: mon_client_id_depuis_script...
[2025-05-02 00:20:07][INFO] ClientSession INFO : Initialisation pour client mon_client_id_depuis_script
[2025-05-02 00:20:07][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:20:07][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:20:07][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:20:07][WARNING] Wallet Impossible de charger le portefeuille pour client ID: mon_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:20:07][DEBUG] Wallet Objet Wallet créé pour client ID: mon_client_id_depuis_script. Chemin du fichier: wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'mon_client_id_depuis_script'. Socket FD: 5
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: mon_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 00:20:07][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : ClientSession pour client ID: mon_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 00:20:07][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 00:20:07][INFO] ClientSession
[2025-05-02 00:20:07][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:20:07][INFO] ClientSession
[2025-05-02 00:20:07][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: mon_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 00:20:07][INFO] ClientSession
[2025-05-02 00:20:18][INFO] Global Nouveau prix SRD-BTC simulé : 97759.5517492053
[2025-05-02 00:20:34][INFO] Global Nouveau prix SRD-BTC simulé : 97675.0039995843
[2025-05-02 00:20:49][INFO] Global Nouveau prix SRD-BTC simulé : 98546.3228684424
[2025-05-02 00:21:04][INFO] Global Nouveau prix SRD-BTC simulé : 97735.9989862405
[2025-05-02 00:21:19][INFO] Global Nouveau prix SRD-BTC simulé : 94539.2120377614
[2025-05-02 00:21:34][INFO] Global Nouveau prix SRD-BTC simulé : 95941.6289372133
[2025-05-02 00:21:49][INFO] Global Nouveau prix SRD-BTC simulé : 95455.6742694028
[2025-05-02 00:22:04][INFO] Global Nouveau prix SRD-BTC simulé : 99167.8742797292
--- Début du log : 1746138222 ---
[2025-05-02 00:23:42][DEBUG] TransactionQueue créée.
[2025-05-02 00:23:42][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 00:23:42][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 00:23:42][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 00:23:42][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 00:23:42][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 00:23:42][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 00:23:42][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 00:23:42][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 00:23:42][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 00:23:42][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 00:23:42][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 00:23:42][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 1 entrées chargées depuis users.txt
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 00:23:42][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 00:23:42][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 00:23:42][INFO] Global Thread de génération de prix initié.
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 00:23:42][INFO] Global Thread de génération de prix démarré.
[2025-05-02 00:23:42][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 00:23:42][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 00:23:42][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 5
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 00:23:42][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 00:23:42][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 00:23:42][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 00:23:42][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 00:23:42][INFO] Global Nouveau prix SRD-BTC simulé : 97585.1662369285
[2025-05-02 00:23:53][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 00:23:53][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 00:23:53][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:23:53][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 00:23:53][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 00:23:53][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 00:23:53][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 00:23:53][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 00:23:53][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 00:23:53][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 00:23:53][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 00:23:53][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:mon_client_id_depuis_script,TOKEN:mon_token_depuis_script
'
[2025-05-02 00:23:53][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'mon_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 00:23:53][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: mon_client_id_depuis_script...
[2025-05-02 00:23:53][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'mon_client_id_depuis_script'...
[2025-05-02 00:23:53][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'mon_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 00:23:53][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 00:23:53][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'mon_client_id_depuis_script'.
[2025-05-02 00:23:53][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'mon_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'mon_client_id_depuis_script' (SUCCESS). Socket FD: 10
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: mon_client_id_depuis_script...
[2025-05-02 00:23:53][INFO] ClientSession INFO : Initialisation pour client mon_client_id_depuis_script
[2025-05-02 00:23:53][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 00:23:53][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 00:23:53][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 00:23:53][WARNING] Wallet Impossible de charger le portefeuille pour client ID: mon_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:23:53][DEBUG] Wallet Objet Wallet créé pour client ID: mon_client_id_depuis_script. Chemin du fichier: wallets/mon_client_id_depuis_script.wallet
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'mon_client_id_depuis_script'. Socket FD: 10
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: mon_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 00:23:53][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : ClientSession pour client ID: mon_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 00:23:53][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 00:23:53][INFO] ClientSession
[2025-05-02 00:23:53][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: mon_client_id_depuis_script
[2025-05-02 00:23:53][INFO] ClientSession
[2025-05-02 00:23:53][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: mon_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 00:23:53][INFO] ClientSession
[2025-05-02 00:23:56][INFO] ClientSession
[2025-05-02 00:23:56][INFO] ClientSession
[2025-05-02 00:23:57][INFO] Global Nouveau prix SRD-BTC simulé : 96763.4718994716
[2025-05-02 00:24:03][INFO] ClientSession
[2025-05-02 00:24:03][INFO] ClientSession
[2025-05-02 00:24:11][INFO] ClientSession
[2025-05-02 00:24:11][INFO] ClientSession
[2025-05-02 00:24:12][INFO] Global Nouveau prix SRD-BTC simulé : 94543.2089177479
[2025-05-02 00:24:27][INFO] Global Nouveau prix SRD-BTC simulé : 98230.5605202932
[2025-05-02 00:24:30][INFO] ClientSession
[2025-05-02 00:24:30][INFO] ClientSession
[2025-05-02 00:24:41][DEBUG] OpenSSL Callback: SSL3 alert write:fatal:decode error
[2025-05-02 00:24:41][WARNING] ServerConnection::receive WARNING : SSL_read retourné 0. Erreur code: 1. Socket FD: 10
[2025-05-02 00:24:41][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 10
[2025-05-02 00:24:41][INFO] ClientSession
[2025-05-02 00:24:41][INFO] ClientSession
[2025-05-02 00:24:42][INFO] Global Nouveau prix SRD-BTC simulé : 99522.9674553628
--- Début du log : 1746168701 ---
[2025-05-02 08:51:41][DEBUG] TransactionQueue créée.
[2025-05-02 08:51:41][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 08:51:41][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 08:51:41][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 08:51:41][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 08:51:41][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 08:51:41][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 08:51:41][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 08:51:41][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 08:51:41][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 08:51:41][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 08:51:41][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 08:51:41][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 1 entrées chargées depuis users.txt
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 08:51:41][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 08:51:41][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 08:51:41][INFO] Global Thread de génération de prix initié.
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 08:51:41][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 08:51:41][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 08:51:41][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 08:51:41][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 08:51:41][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 08:51:41][INFO] Global Thread de génération de prix démarré.
[2025-05-02 08:51:41][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 08:51:41][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 08:51:41][INFO] Global Nouveau prix SRD-BTC simulé : 98292.2818145430
[2025-05-02 08:51:52][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 5, IP: 10.188.240.101
[2025-05-02 08:51:52][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 5
[2025-05-02 08:51:52][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 5
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 08:51:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 08:51:52][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 08:51:52][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 08:51:52][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 08:51:52][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 5
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 5
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 5
[2025-05-02 08:51:52][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (5) et SSL existants.
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 5
[2025-05-02 08:51:52][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 08:51:52][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 5
[2025-05-02 08:51:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 5 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 08:51:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 5
[2025-05-02 08:51:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 08:51:52][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 08:51:52][DEBUG] Server::processAuthRequest DEBUG : ID non trouvé : 'nouveau_client_id_depuis_script'. Tentative d'enregistrement...
[2025-05-02 08:51:52][WARNING] SecurityUtils WARNING : HashPasswordSecure est un placeholder. REMPLACER PAR UN VRAI HACHAGE SECURISÉ (bcrypt, Argon2) !
[2025-05-02 08:51:52][DEBUG] Server::processAuthRequest DEBUG : Nouvel utilisateur 'nouveau_client_id_depuis_script' ajouté à map en mémoire.
[2025-05-02 08:51:52][INFO] Server::SaveUsersInternal INFO : Sauvegarde de 2 utilisateurs dans users.txt
[2025-05-02 08:51:52][INFO] Server::processAuthRequest INFO : Liste utilisateurs sauvegardée sur disque après ajout ID: 'nouveau_client_id_depuis_script'.
[2025-05-02 08:51:52][DEBUG] Server::CreateWalletFile DEBUG : Tentative création fichier portefeuille: wallets//nouveau_client_id_depuis_script.wallet
[2025-05-02 08:51:52][WARNING] Server::CreateWalletFile WARNING : std::filesystem::create_directories retourné false mais ec non set. État inconnu répertoire.
[2025-05-02 08:51:52][DEBUG] Server::CreateWalletFile DEBUG : Fichier portefeuille ouvert/créé : wallets//nouveau_client_id_depuis_script.wallet
[2025-05-02 08:51:52][INFO] Server::CreateWalletFile INFO : Fichier portefeuille vierge créé et initialisé : wallets//nouveau_client_id_depuis_script.wallet
[2025-05-02 08:51:52][INFO] Server::processAuthRequest INFO : Fichier portefeuille créé avec succès pour ID: 'nouveau_client_id_depuis_script'.
[2025-05-02 08:51:52][INFO] Server::processAuthRequest INFO : Enregistrement nouvel utilisateur 'nouveau_client_id_depuis_script' réussi.
[2025-05-02 08:51:52][INFO] ClientAuthenticator::AuthenticateClient INFO : Enregistrement nouvel utilisateur et authentification réussie pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH NEW au client.
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (NEW). Socket FD: 5
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 08:51:52][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 08:51:52][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 08:51:52][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 08:51:52][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 08:51:52][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 08:51:52][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 5
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 08:51:52][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 08:51:52][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 08:51:52][INFO] ClientSession
[2025-05-02 08:51:52][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 08:51:52][INFO] ClientSession
[2025-05-02 08:51:52][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 08:51:52][INFO] ClientSession
[2025-05-02 08:51:56][INFO] Global Nouveau prix SRD-BTC simulé : 99513.5644849188
[2025-05-02 08:52:12][INFO] Global Nouveau prix SRD-BTC simulé : 95575.0684677334
[2025-05-02 08:52:27][INFO] Global Nouveau prix SRD-BTC simulé : 93839.3388973463
[2025-05-02 08:52:42][INFO] Global Nouveau prix SRD-BTC simulé : 96851.2570759012
[2025-05-02 08:52:57][INFO] Global Nouveau prix SRD-BTC simulé : 97547.7906969332
[2025-05-02 08:53:12][INFO] Global Nouveau prix SRD-BTC simulé : 95337.2220285376
[2025-05-02 08:53:16][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 08:53:16][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 5
[2025-05-02 08:53:16][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 5
[2025-05-02 08:53:16][INFO] ClientSession
[2025-05-02 08:53:16][INFO] ClientSession
[2025-05-02 08:53:27][INFO] Global Nouveau prix SRD-BTC simulé : 98586.0514819567
[2025-05-02 08:53:31][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 08:53:31][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 08:53:31][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 08:53:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 08:53:31][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 08:53:31][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 08:53:31][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 08:53:31][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 08:53:31][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 08:53:31][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 08:53:31][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 08:53:31][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 08:53:31][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 08:53:31][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 08:53:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 08:53:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 08:53:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 08:53:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 08:53:31][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 08:53:31][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 08:53:31][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 08:53:31][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 08:53:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 08:53:31][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 10
[2025-05-02 08:53:31][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 08:53:31][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 08:53:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 08:53:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 08:53:31][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 08:53:31][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 08:53:31][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 08:53:31][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 10
[2025-05-02 08:53:31][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 08:53:31][INFO] ClientSession
[2025-05-02 08:53:31][INFO] ClientSession
[2025-05-02 08:53:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 08:53:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 08:53:31][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 08:53:31][INFO] ClientSession
--- Début du log : 1746169739 ---
[2025-05-02 09:08:59][DEBUG] TransactionQueue créée.
[2025-05-02 09:08:59][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 09:08:59][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 09:08:59][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 09:08:59][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 09:08:59][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 09:08:59][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 09:08:59][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 09:08:59][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 09:08:59][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 09:08:59][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 09:08:59][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:08:59][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 09:08:59][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 09:08:59][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 09:08:59][INFO] Global Thread de génération de prix initié.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 09:08:59][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 09:08:59][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 09:08:59][INFO] Global Thread de génération de prix démarré.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 09:08:59][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 09:08:59][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 09:08:59][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 09:08:59][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 09:08:59][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 09:09:00][INFO] Global Nouveau prix SRD-BTC simulé : 95421.5563161594
[2025-05-02 09:09:08][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 09:09:08][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 09:09:08][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:09:08][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:09:08][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:09:08][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 09:09:08][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 09:09:08][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 6
[2025-05-02 09:09:08][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 09:09:08][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:09:08][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 09:09:08][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:09:08][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 09:09:08][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:09:08][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:09:08][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:09:08][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:09:08][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:09:08][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 6
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:09:08][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:09:08][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:09:08][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:09:08][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:09:08][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:09:08][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 6
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 09:09:08][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 09:09:08][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 09:09:08][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 09:09:08][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 09:09:08][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 09:09:08][INFO] ClientSession
[2025-05-02 09:09:15][INFO] Global Nouveau prix SRD-BTC simulé : 97114.5647697309
[2025-05-02 09:09:28][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 09:09:28][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 6
[2025-05-02 09:09:28][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 6
[2025-05-02 09:09:28][INFO] ClientSession
[2025-05-02 09:09:28][INFO] ClientSession
[2025-05-02 09:09:30][INFO] Global Nouveau prix SRD-BTC simulé : 99086.1256911345
[2025-05-02 09:09:32][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 09:09:32][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 09:09:32][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:09:32][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:09:32][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:09:32][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:09:32][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:09:32][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 09:09:32][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 09:09:32][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 09:09:32][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 09:09:32][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 09:09:32][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:09:32][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:09:32][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 09:09:32][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:09:32][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 09:09:32][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:09:32][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:09:32][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:09:32][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:09:32][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:09:32][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:09:32][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 10
[2025-05-02 09:09:32][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:09:32][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:09:32][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:09:32][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:09:32][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:09:32][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:09:32][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:09:32][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 10
[2025-05-02 09:09:32][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:09:32][INFO] ClientSession INFO : Destruction de la session pour client nouveau_client_id_depuis_script
[2025-05-02 09:09:32][WARNING] ClientSession WARNING : La session nouveau_client_id_depuis_script n'était pas en cours d'exécution lors de la demande d'arrêt.
[2025-05-02 09:09:32][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:09:32][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:09:32][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:09:32][INFO] ClientSession INFO : Portefeuille sauvegardé pour nouveau_client_id_depuis_script avant destruction.
--- Début du log : 1746171382 ---
[2025-05-02 09:36:22][DEBUG] TransactionQueue créée.
[2025-05-02 09:36:22][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 09:36:22][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 09:36:22][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 09:36:22][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 09:36:22][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 09:36:22][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 09:36:22][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 09:36:22][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 09:36:22][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 09:36:22][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 09:36:22][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:36:22][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 09:36:22][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 09:36:22][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 09:36:22][INFO] Global Thread de génération de prix initié.
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 09:36:22][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 09:36:22][INFO] Global Thread de génération de prix démarré.
[2025-05-02 09:36:22][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 09:36:22][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 09:36:22][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 10
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 09:36:22][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 09:36:22][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 09:36:22][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 09:36:23][INFO] Global Nouveau prix SRD-BTC simulé : 97183.5087644283
[2025-05-02 09:36:31][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 11, IP: 10.188.240.101
[2025-05-02 09:36:31][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 11
[2025-05-02 09:36:31][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 11
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:36:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:36:31][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:36:31][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 09:36:31][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 09:36:31][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 11
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 11
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 11
[2025-05-02 09:36:31][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (11) et SSL existants.
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 11
[2025-05-02 09:36:31][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:36:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 11
[2025-05-02 09:36:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 11 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:36:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 11
[2025-05-02 09:36:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:36:31][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:36:31][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:36:31][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:36:31][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:36:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 11
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:36:31][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:36:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:36:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:36:31][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:36:31][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:36:31][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 11
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 09:36:31][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 09:36:31][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 09:36:31][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 09:36:31][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 09:36:31][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 09:36:31][INFO] ClientSession INFO : Thread de session démarré pour client nouveau_client_id_depuis_script
[2025-05-02 09:36:38][INFO] Global Nouveau prix SRD-BTC simulé : 96390.5045006881
[2025-05-02 09:36:45][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 09:36:53][INFO] Global Nouveau prix SRD-BTC simulé : 98278.9043114237
[2025-05-02 09:37:08][INFO] Global Nouveau prix SRD-BTC simulé : 94644.1375508814
[2025-05-02 09:37:23][INFO] Global Nouveau prix SRD-BTC simulé : 95158.3970875284
[2025-05-02 09:37:38][INFO] Global Nouveau prix SRD-BTC simulé : 99151.0391364146
[2025-05-02 09:37:41][DEBUG] OpenSSL Callback: SSL3 alert write:fatal:decode error
[2025-05-02 09:37:41][WARNING] ServerConnection::receive WARNING : SSL_read retourné 0. Erreur code: 1. Socket FD: 11
[2025-05-02 09:37:41][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 11
[2025-05-02 09:37:41][INFO] ClientSession INFO : Déconnexion propre détectée pour client nouveau_client_id_depuis_script. Socket FD: 11
[2025-05-02 09:37:41][INFO] ClientSession INFO : Sortie de la boucle de session pour client nouveau_client_id_depuis_script. Raison: running=0, client_connected=0
[2025-05-02 09:37:53][INFO] Global Nouveau prix SRD-BTC simulé : 97549.3107278046
[2025-05-02 09:38:08][INFO] Global Nouveau prix SRD-BTC simulé : 94668.0925120381
[2025-05-02 09:38:23][INFO] Global Nouveau prix SRD-BTC simulé : 97433.4420788197
[2025-05-02 09:38:38][INFO] Global Nouveau prix SRD-BTC simulé : 96584.4853517615
[2025-05-02 09:38:53][INFO] Global Nouveau prix SRD-BTC simulé : 98923.7334553923
[2025-05-02 09:39:08][INFO] Global Nouveau prix SRD-BTC simulé : 96220.9112897938
[2025-05-02 09:39:23][INFO] Global Nouveau prix SRD-BTC simulé : 98379.8500958209
[2025-05-02 09:39:38][INFO] Global Nouveau prix SRD-BTC simulé : 93975.0224759572
[2025-05-02 09:39:53][INFO] Global Nouveau prix SRD-BTC simulé : 94029.9983984385
[2025-05-02 09:40:08][INFO] Global Nouveau prix SRD-BTC simulé : 97593.4108245993
[2025-05-02 09:40:23][INFO] Global Nouveau prix SRD-BTC simulé : 96526.1676723935
[2025-05-02 09:40:38][INFO] Global Nouveau prix SRD-BTC simulé : 94687.9161577033
[2025-05-02 09:40:53][INFO] Global Nouveau prix SRD-BTC simulé : 99305.1599717626
[2025-05-02 09:41:09][INFO] Global Nouveau prix SRD-BTC simulé : 98328.5075828029
[2025-05-02 09:41:24][INFO] Global Nouveau prix SRD-BTC simulé : 96413.4431584449
[2025-05-02 09:41:39][INFO] Global Nouveau prix SRD-BTC simulé : 97521.9777443051
[2025-05-02 09:41:54][INFO] Global Nouveau prix SRD-BTC simulé : 96521.3600458801
[2025-05-02 09:42:09][INFO] Global Nouveau prix SRD-BTC simulé : 95386.4964061300
[2025-05-02 09:42:24][INFO] Global Nouveau prix SRD-BTC simulé : 99096.4938025312
[2025-05-02 09:42:39][INFO] Global Nouveau prix SRD-BTC simulé : 98339.0568715352
[2025-05-02 09:42:54][INFO] Global Nouveau prix SRD-BTC simulé : 96546.6074666697
[2025-05-02 09:43:09][INFO] Global Nouveau prix SRD-BTC simulé : 97491.1934876602
[2025-05-02 09:43:24][INFO] Global Nouveau prix SRD-BTC simulé : 96948.3198372616
[2025-05-02 09:43:39][INFO] Global Nouveau prix SRD-BTC simulé : 98727.1892458265
--- Début du log : 1746171852 ---
[2025-05-02 09:44:12][DEBUG] TransactionQueue créée.
[2025-05-02 09:44:12][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 09:44:12][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 09:44:12][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 09:44:12][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 09:44:12][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 09:44:12][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 09:44:12][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 09:44:12][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 09:44:12][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 09:44:12][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 09:44:12][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:44:12][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 09:44:12][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 09:44:12][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 09:44:12][INFO] Global Thread de génération de prix initié.
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 09:44:12][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 09:44:12][INFO] Global Thread de génération de prix démarré.
[2025-05-02 09:44:12][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 09:44:12][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 09:44:12][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 09:44:12][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 09:44:12][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 09:44:12][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 09:44:12][INFO] Global Nouveau prix SRD-BTC simulé : 97891.3819161745
[2025-05-02 09:44:18][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 8, IP: 10.188.240.101
[2025-05-02 09:44:18][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 8
[2025-05-02 09:44:18][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 8
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:44:18][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:44:18][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:44:18][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 8
[2025-05-02 09:44:18][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 8
[2025-05-02 09:44:18][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 8
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 8
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 8
[2025-05-02 09:44:18][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (8) et SSL existants.
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 8
[2025-05-02 09:44:18][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:44:18][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 8
[2025-05-02 09:44:18][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 8 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:44:18][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 8
[2025-05-02 09:44:18][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:44:18][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:44:18][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:44:18][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:44:18][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:44:18][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 8
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:44:18][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:44:18][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:44:18][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:44:18][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:44:18][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:44:18][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 8
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 09:44:18][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 09:44:18][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 09:44:18][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 09:44:18][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 09:44:18][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 09:44:18][INFO] ClientSession INFO : Thread de session démarré pour client nouveau_client_id_depuis_script
[2025-05-02 09:44:26][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 09:44:26][INFO] ClientSession
[2025-05-02 09:44:27][INFO] Global Nouveau prix SRD-BTC simulé : 96227.4784538853
[2025-05-02 09:44:42][INFO] Global Nouveau prix SRD-BTC simulé : 95624.2395230851
[2025-05-02 09:44:43][DEBUG] ClientSession DEBUG : Reçu 4 octets. Buffer d'accumulation: 4 octets.
[2025-05-02 09:44:43][INFO] ClientSession
[2025-05-02 09:44:57][INFO] Global Nouveau prix SRD-BTC simulé : 95661.7159755733
[2025-05-02 09:45:00][DEBUG] ClientSession DEBUG : Reçu 16 octets. Buffer d'accumulation: 16 octets.
[2025-05-02 09:45:00][INFO] ClientSession
[2025-05-02 09:45:12][INFO] Global Nouveau prix SRD-BTC simulé : 97404.6280573144
[2025-05-02 09:45:20][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 09:45:20][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 8
[2025-05-02 09:45:20][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 8
[2025-05-02 09:45:20][INFO] ClientSession INFO : Déconnexion propre détectée pour client nouveau_client_id_depuis_script. Socket FD: 8
[2025-05-02 09:45:20][INFO] ClientSession INFO : Sortie de la boucle de session pour client nouveau_client_id_depuis_script. Raison: running=0, client_connected=0
[2025-05-02 09:45:23][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 09:45:23][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:45:23][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:45:23][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:45:23][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:45:23][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 09:45:23][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 09:45:23][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 09:45:23][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:45:23][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:45:23][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:45:23][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 09:45:23][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:45:23][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:45:23][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:45:23][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:45:23][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:45:23][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:45:23][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 10
[2025-05-02 09:45:23][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'nouveau_client_id_depuis_script' est déjà active. Socket FD: 10
[2025-05-02 09:45:23][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 10
[2025-05-02 09:45:23][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 09:45:23][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 09:45:23][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 09:45:23][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 10
[2025-05-02 09:45:23][INFO] ServerConnection::closeConnection INFO : Socket FD: 10 fermé.
[2025-05-02 09:45:23][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 09:45:23][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 09:45:23][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 09:45:28][INFO] Global Nouveau prix SRD-BTC simulé : 97338.5616457559
[2025-05-02 09:45:43][INFO] Global Nouveau prix SRD-BTC simulé : 97463.8826400240
[2025-05-02 09:45:58][INFO] Global Nouveau prix SRD-BTC simulé : 96701.9202116663
[2025-05-02 09:46:13][INFO] Global Nouveau prix SRD-BTC simulé : 96878.1646677292
[2025-05-02 09:46:28][INFO] Global Nouveau prix SRD-BTC simulé : 96691.1614175291
[2025-05-02 09:46:43][INFO] Global Nouveau prix SRD-BTC simulé : 97809.9866754583
--- Début du log : 1746172279 ---
[2025-05-02 09:51:19][DEBUG] TransactionQueue créée.
[2025-05-02 09:51:19][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 09:51:19][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: wallets/
[2025-05-02 09:51:19][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 09:51:19][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 09:51:19][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 09:51:19][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 09:51:19][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 09:51:19][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 09:51:19][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 09:51:19][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 09:51:19][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:51:19][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 09:51:19][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 09:51:19][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 09:51:19][INFO] Global Thread de génération de prix initié.
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 09:51:19][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 09:51:19][INFO] Global Thread de génération de prix démarré.
[2025-05-02 09:51:19][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 09:51:19][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 09:51:19][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 09:51:19][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 09:51:19][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 09:51:19][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 09:51:20][INFO] Global Nouveau prix SRD-BTC simulé : 95578.0073694584
[2025-05-02 09:51:27][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 09:51:27][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 09:51:27][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:51:27][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:51:28][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:51:28][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:51:28][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 09:51:28][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 09:51:28][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 6
[2025-05-02 09:51:28][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 09:51:28][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:51:28][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 09:51:28][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:51:28][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 09:51:28][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:51:28][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:51:28][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:51:28][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:51:28][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:51:28][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 6
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:51:28][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:51:28][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : wallets
[2025-05-02 09:51:28][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:51:28][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire 'wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:51:28][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:51:28][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 6
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 09:51:28][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 09:51:28][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 09:51:28][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 09:51:28][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 09:51:28][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 09:51:28][INFO] ClientSession INFO : Thread de session démarré pour client nouveau_client_id_depuis_script
[2025-05-02 09:51:35][INFO] Global Nouveau prix SRD-BTC simulé : 96425.2772384412
[2025-05-02 09:51:46][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 09:51:46][INFO] ClientSession
[2025-05-02 09:51:50][INFO] Global Nouveau prix SRD-BTC simulé : 97113.5603230037
[2025-05-02 09:52:00][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 09:52:00][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 6
[2025-05-02 09:52:00][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 6
[2025-05-02 09:52:00][INFO] ClientSession INFO : Déconnexion propre détectée pour client nouveau_client_id_depuis_script. Socket FD: 6
[2025-05-02 09:52:00][INFO] ClientSession INFO : Sortie de la boucle de session pour client nouveau_client_id_depuis_script. Raison: running=0, client_connected=0
[2025-05-02 09:52:05][INFO] Global Nouveau prix SRD-BTC simulé : 97308.7825500171
--- Début du log : 1746172787 ---
[2025-05-02 09:59:47][DEBUG] TransactionQueue créée.
[2025-05-02 09:59:47][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 09:59:47][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 09:59:47][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 09:59:47][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 09:59:47][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 09:59:47][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 09:59:47][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 09:59:47][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 09:59:47][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 09:59:47][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 09:59:47][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 09:59:47][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 09:59:47][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 09:59:47][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 09:59:47][INFO] Global Thread de génération de prix initié.
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 09:59:47][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 09:59:47][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 09:59:47][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 09:59:47][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 09:59:47][INFO] Global Thread de génération de prix démarré.
[2025-05-02 09:59:47][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 09:59:47][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 09:59:47][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 09:59:47][INFO] Global Nouveau prix SRD-BTC simulé : 97603.3955075464
[2025-05-02 09:59:58][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 09:59:58][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 09:59:58][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:59:58][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 09:59:58][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 09:59:58][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:59:58][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 09:59:58][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 09:59:58][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 09:59:58][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 09:59:58][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 09:59:58][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 09:59:58][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 09:59:58][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 09:59:58][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 09:59:58][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 09:59:58][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 09:59:58][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 09:59:58][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 10
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 09:59:58][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 09:59:58][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 09:59:58][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 09:59:58][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire '../src/data/wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 09:59:58][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : ../src/data/wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:59:58][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: ../src/data/wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 10
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 09:59:58][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 09:59:58][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 09:59:58][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 09:59:58][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 09:59:58][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 09:59:58][INFO] ClientSession INFO : Thread de session démarré pour client nouveau_client_id_depuis_script
[2025-05-02 10:00:02][INFO] Global Nouveau prix SRD-BTC simulé : 98224.5369786652
[2025-05-02 10:00:06][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 10:00:06][INFO] ClientSession
[2025-05-02 10:00:11][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 10:00:11][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 10
[2025-05-02 10:00:11][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 10
[2025-05-02 10:00:11][INFO] ClientSession INFO : Déconnexion propre détectée pour client nouveau_client_id_depuis_script. Socket FD: 10
[2025-05-02 10:00:11][INFO] ClientSession INFO : Sortie de la boucle de session pour client nouveau_client_id_depuis_script. Raison: running=0, client_connected=0
--- Début du log : 1746172913 ---
[2025-05-02 10:01:53][DEBUG] TransactionQueue créée.
[2025-05-02 10:01:53][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 10:01:53][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 10:01:53][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 10:01:53][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 10:01:53][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 10:01:53][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 10:01:53][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 10:01:53][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 10:01:53][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 10:01:53][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 10:01:53][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:01:53][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 10:01:53][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 10:01:53][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 10:01:53][INFO] Global Thread de génération de prix initié.
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 10:01:53][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 10:01:53][INFO] Global Thread de génération de prix démarré.
[2025-05-02 10:01:53][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 10:01:53][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 10:01:53][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 10:01:53][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 10:01:53][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 10:01:53][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 10:01:53][INFO] Global Nouveau prix SRD-BTC simulé : 96513.1926553044
[2025-05-02 10:01:59][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 8, IP: 10.188.240.101
[2025-05-02 10:01:59][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 8
[2025-05-02 10:01:59][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 8
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:01:59][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:01:59][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:01:59][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 8
[2025-05-02 10:01:59][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 8
[2025-05-02 10:01:59][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 8
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 8
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 8
[2025-05-02 10:01:59][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (8) et SSL existants.
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 8
[2025-05-02 10:01:59][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:01:59][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 8
[2025-05-02 10:01:59][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 8 : 'ID:nouveau_client_id_depuis_script,TOKEN:nouveau_token_depuis_script
'
[2025-05-02 10:01:59][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'nouveau_client_id_depuis_script', Mot de passe: '[CACHÉ]'. Socket FD: 8
[2025-05-02 10:01:59][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: nouveau_client_id_depuis_script...
[2025-05-02 10:01:59][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'nouveau_client_id_depuis_script'...
[2025-05-02 10:01:59][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'nouveau_client_id_depuis_script'. Vérification du mot de passe...
[2025-05-02 10:01:59][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 10:01:59][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'nouveau_client_id_depuis_script'.
[2025-05-02 10:01:59][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'nouveau_client_id_depuis_script'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'nouveau_client_id_depuis_script' (SUCCESS). Socket FD: 8
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: nouveau_client_id_depuis_script...
[2025-05-02 10:01:59][INFO] ClientSession INFO : Initialisation pour client nouveau_client_id_depuis_script
[2025-05-02 10:01:59][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 10:01:59][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 10:01:59][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire '../src/data/wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 10:01:59][WARNING] Wallet Impossible de charger le portefeuille pour client ID: nouveau_client_id_depuis_script. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : ../src/data/wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 10:01:59][DEBUG] Wallet Objet Wallet créé pour client ID: nouveau_client_id_depuis_script. Chemin du fichier: ../src/data/wallets/nouveau_client_id_depuis_script.wallet
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'nouveau_client_id_depuis_script'. Socket FD: 8
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: nouveau_client_id_depuis_script. Total sessions actives: 1.
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 10:01:59][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: nouveau_client_id_depuis_script
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : ClientSession pour client ID: nouveau_client_id_depuis_script enregistrée auprès de la TransactionQueue.
[2025-05-02 10:01:59][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 10:01:59][INFO] ClientSession INFO : Démarrage du thread de session pour client nouveau_client_id_depuis_script
[2025-05-02 10:01:59][INFO] ClientSession INFO : Thread de session démarré et joignable pour client nouveau_client_id_depuis_script
[2025-05-02 10:01:59][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: nouveau_client_id_depuis_script. Le thread HandleClient va se terminer normalement.
[2025-05-02 10:01:59][INFO] ClientSession INFO : Thread de session démarré pour client nouveau_client_id_depuis_script
[2025-05-02 10:02:07][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 10:02:07][INFO] ClientSession
[2025-05-02 10:02:08][INFO] Global Nouveau prix SRD-BTC simulé : 96205.2448337502
[2025-05-02 10:02:16][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 10:02:16][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 8
[2025-05-02 10:02:16][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 8
[2025-05-02 10:02:16][INFO] ClientSession INFO : Déconnexion propre détectée pour client nouveau_client_id_depuis_script. Socket FD: 8
[2025-05-02 10:02:16][INFO] ClientSession INFO : Sortie de la boucle de session pour client nouveau_client_id_depuis_script. Raison: running=0, client_connected=0
[2025-05-02 10:02:23][INFO] Global Nouveau prix SRD-BTC simulé : 98554.3023233844
[2025-05-02 10:02:38][INFO] Global Nouveau prix SRD-BTC simulé : 98287.8975511258
--- Début du log : 1746172987 ---
[2025-05-02 10:03:07][DEBUG] TransactionQueue créée.
[2025-05-02 10:03:07][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 10:03:07][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 10:03:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 10:03:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 10:03:07][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 10:03:07][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 10:03:07][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 10:03:07][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 10:03:07][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 10:03:07][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 10:03:07][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:03:07][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 2 entrées chargées depuis users.txt
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 10:03:07][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 10:03:07][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 10:03:07][INFO] Global Thread de génération de prix initié.
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 10:03:07][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 10:03:07][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 10:03:07][INFO] Global Thread de génération de prix démarré.
[2025-05-02 10:03:07][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 10:03:07][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 10:03:07][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 10:03:07][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 10:03:07][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 10:03:07][INFO] Global Nouveau prix SRD-BTC simulé : 98259.9095760781
[2025-05-02 10:03:13][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 10:03:13][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 10:03:13][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:03:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:03:13][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:03:13][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 10:03:13][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 10:03:13][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 6
[2025-05-02 10:03:13][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 10:03:13][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:03:13][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 10:03:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 10:03:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 10:03:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 10:03:13][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 10:03:13][DEBUG] Server::processAuthRequest DEBUG : ID non trouvé : 'Client1'. Tentative d'enregistrement...
[2025-05-02 10:03:13][WARNING] SecurityUtils WARNING : HashPasswordSecure est un placeholder. REMPLACER PAR UN VRAI HACHAGE SECURISÉ (bcrypt, Argon2) !
[2025-05-02 10:03:13][DEBUG] Server::processAuthRequest DEBUG : Nouvel utilisateur 'Client1' ajouté à map en mémoire.
[2025-05-02 10:03:13][INFO] Server::SaveUsersInternal INFO : Sauvegarde de 3 utilisateurs dans users.txt
[2025-05-02 10:03:13][INFO] Server::processAuthRequest INFO : Liste utilisateurs sauvegardée sur disque après ajout ID: 'Client1'.
[2025-05-02 10:03:13][DEBUG] Server::CreateWalletFile DEBUG : Tentative création fichier portefeuille: ../src/data/wallets//Client1.wallet
[2025-05-02 10:03:13][WARNING] Server::CreateWalletFile WARNING : std::filesystem::create_directories retourné false mais ec non set. État inconnu répertoire.
[2025-05-02 10:03:13][DEBUG] Server::CreateWalletFile DEBUG : Fichier portefeuille ouvert/créé : ../src/data/wallets//Client1.wallet
[2025-05-02 10:03:13][INFO] Server::CreateWalletFile INFO : Fichier portefeuille vierge créé et initialisé : ../src/data/wallets//Client1.wallet
[2025-05-02 10:03:13][INFO] Server::processAuthRequest INFO : Fichier portefeuille créé avec succès pour ID: 'Client1'.
[2025-05-02 10:03:13][INFO] Server::processAuthRequest INFO : Enregistrement nouvel utilisateur 'Client1' réussi.
[2025-05-02 10:03:13][INFO] ClientAuthenticator::AuthenticateClient INFO : Enregistrement nouvel utilisateur et authentification réussie pour ID: 'Client1'. Envoi réponse AUTH NEW au client.
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (NEW). Socket FD: 6
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1...
[2025-05-02 10:03:13][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 10:03:13][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 10:03:13][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 10:03:13][ERROR] Wallet::ensureWalletsDirectoryExists ERROR: Impossible de créer/vérifier répertoire '../src/data/wallets'. Raison (errno): Success. Comportement create_directories inhabituel (ec vide).
[2025-05-02 10:03:13][WARNING] Wallet Impossible de charger le portefeuille pour client ID: Client1. Un nouveau portefeuille vierge sera utilisé. Chemin cherché : ../src/data/wallets/Client1.wallet
[2025-05-02 10:03:13][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'Client1'. Socket FD: 6
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 10:03:13][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 10:03:13][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 10:03:13][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 10:03:13][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 10:03:13][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 10:03:13][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 10:03:17][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 10:03:17][INFO] ClientSession
[2025-05-02 10:03:22][INFO] Global Nouveau prix SRD-BTC simulé : 96828.3569121330
--- Début du log : 1746174447 ---
[2025-05-02 10:27:27][DEBUG] TransactionQueue créée.
[2025-05-02 10:27:27][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 10:27:27][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 10:27:27][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 10:27:27][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 10:27:27][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 10:27:27][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 10:27:27][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 10:27:27][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 10:27:27][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 10:27:27][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 10:27:27][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:27:27][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 3 entrées chargées depuis users.txt
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 10:27:27][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 10:27:27][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 10:27:27][INFO] Global Thread de génération de prix initié.
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 10:27:27][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 10:27:27][INFO] Global Thread de génération de prix démarré.
[2025-05-02 10:27:27][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 10:27:27][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 10:27:27][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 10:27:27][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 10:27:27][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 10:27:27][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 10:27:27][INFO] Global Nouveau prix SRD-BTC simulé : 95126.0297224921
[2025-05-02 10:27:31][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 10:27:31][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 10:27:31][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:27:31][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:27:31][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:27:31][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 10:27:31][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 10:27:31][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 10:27:31][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 10:27:31][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:27:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 10:27:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 10:27:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 10:27:31][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 10:27:31][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 10:27:31][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 10:27:31][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 10:27:31][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 10:27:31][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1...
[2025-05-02 10:27:31][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 10:27:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 10:27:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 10:27:31][WARNING] Wallet::ensureWalletsDirectoryExists WARNING: create_directories retourné false MAIS ec vide. Comportement inhabituel. Chemin: '../src/data/wallets'.
[2025-05-02 10:27:31][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Vérification manuelle après échec create_directories: exists() retour 1, ec_check.message : 'Success'
[2025-05-02 10:27:31][INFO] Wallet::ensureWalletsDirectoryExists INFO: Répertoire '../src/data/wallets' existe bien malgré l'échec bizarre de create_directories. Considéré comme succès pour la suite.
[2025-05-02 10:27:31][DEBUG] Wallet Lecture du fichier portefeuille : ../src/data/wallets/Client1.wallet
[2025-05-02 10:27:31][INFO] Wallet Portefeuille (Client1) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-02 10:27:31][INFO] Wallet Portefeuille chargé avec succès pour client ID: Client1 depuis ../src/data/wallets/Client1.wallet
[2025-05-02 10:27:31][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'Client1'. Socket FD: 10
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 10:27:31][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 10:27:31][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 10:27:31][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 10:27:31][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 10:27:31][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 10:27:31][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 10:27:37][DEBUG] ClientSession DEBUG : Reçu 5 octets. Buffer d'accumulation: 5 octets.
[2025-05-02 10:27:37][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW'
[2025-05-02 10:27:37][WARNING] ClientSession WARNING : Cible inconnue pour SHOW reçue pour client Client1 : 'SHOW'
[2025-05-02 10:27:37][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: ERROR: Unknown SHOW target. Use SHOW WALLET or SHOW TRANSACTIONS.
...
[2025-05-02 10:27:37][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW'
[2025-05-02 10:27:42][INFO] Global Nouveau prix SRD-BTC simulé : 98462.6472854132
[2025-05-02 10:27:44][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 10:27:44][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 10:27:44][INFO] ClientSession INFO : Commande SHOW WALLET reçue pour client Client1
[2025-05-02 10:27:44][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: BALANCE USD: 10000.0000000000, SRD-BTC: 0.0000000000
...
[2025-05-02 10:27:44][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 10:27:54][DEBUG] OpenSSL Callback: SSL3 alert read:warning:close notify
[2025-05-02 10:27:54][INFO] ServerConnection::receive INFO : Connexion fermée proprement par le pair (SSL_ERROR_ZERO_RETURN). Socket FD: 10
[2025-05-02 10:27:54][DEBUG] ServerConnection::markForClose DEBUG : Connexion marquée pour fermeture. Socket FD: 10
[2025-05-02 10:27:54][INFO] ClientSession INFO : Déconnexion propre détectée pour client Client1. Socket FD: 10
[2025-05-02 10:27:54][INFO] ClientSession INFO : Sortie de la boucle de session pour client Client1. Raison: running=0, client_connected=0
[2025-05-02 10:27:57][INFO] Global Nouveau prix SRD-BTC simulé : 95169.8323085469
[2025-05-02 10:28:01][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 9, IP: 10.188.240.101
[2025-05-02 10:28:01][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:28:01][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:28:01][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 9
[2025-05-02 10:28:01][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 9
[2025-05-02 10:28:01][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 9
[2025-05-02 10:28:01][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 9
[2025-05-02 10:28:01][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (9) et SSL existants.
[2025-05-02 10:28:01][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:28:01][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:28:01][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 9 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 10:28:01][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 9
[2025-05-02 10:28:01][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 10:28:01][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 10:28:01][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 10:28:01][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 10:28:01][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 10:28:01][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 10:28:01][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 9
[2025-05-02 10:28:01][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 9
[2025-05-02 10:28:01][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 9
[2025-05-02 10:28:01][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 10:28:01][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 10:28:01][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 10:28:01][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 9
[2025-05-02 10:28:01][INFO] ServerConnection::closeConnection INFO : Socket FD: 9 fermé.
[2025-05-02 10:28:01][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 10:28:01][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 10:28:01][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 10:28:12][INFO] Global Nouveau prix SRD-BTC simulé : 94181.7719231395
[2025-05-02 10:28:27][INFO] Global Nouveau prix SRD-BTC simulé : 95632.7750709708
[2025-05-02 10:28:42][INFO] Global Nouveau prix SRD-BTC simulé : 96492.0326574989
[2025-05-02 10:28:57][INFO] Global Nouveau prix SRD-BTC simulé : 96315.3645687492
[2025-05-02 10:29:12][INFO] Global Nouveau prix SRD-BTC simulé : 93301.6683005441
[2025-05-02 10:29:27][INFO] Global Nouveau prix SRD-BTC simulé : 97161.9727139078
--- Début du log : 1746175993 ---
[2025-05-02 10:53:13][DEBUG] TransactionQueue créée.
[2025-05-02 10:53:13][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 10:53:13][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 10:53:13][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 10:53:13][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 10:53:13][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 10:53:13][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 10:53:13][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 10:53:13][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 10:53:13][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 10:53:13][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 10:53:13][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 10:53:13][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 3 entrées chargées depuis users.txt
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 10:53:13][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 10:53:13][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 10:53:13][INFO] Global Thread de génération de prix initié.
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 10:53:13][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 10:53:13][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 10:53:13][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 10:53:13][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 10:53:13][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 10:53:13][INFO] Global Thread de génération de prix démarré.
[2025-05-02 10:53:13][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 10:53:13][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 10:53:13][INFO] Global Nouveau prix SRD-BTC simulé : 97125.0951682292
[2025-05-02 10:53:17][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 5, IP: 10.188.240.101
[2025-05-02 10:53:17][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 5
[2025-05-02 10:53:17][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 5
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:53:17][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:53:17][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:53:17][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 10:53:17][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 5
[2025-05-02 10:53:17][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 5
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 5
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 5
[2025-05-02 10:53:17][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (5) et SSL existants.
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 5
[2025-05-02 10:53:17][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:53:17][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 5
[2025-05-02 10:53:17][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 5 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 10:53:17][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 5
[2025-05-02 10:53:17][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 10:53:17][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 10:53:17][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 10:53:17][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 10:53:17][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 10:53:17][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 5
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1...
[2025-05-02 10:53:17][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 10:53:17][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 10:53:17][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 10:53:17][WARNING] Wallet::ensureWalletsDirectoryExists WARNING: create_directories retourné false MAIS ec vide. Comportement inhabituel. Chemin: '../src/data/wallets'.
[2025-05-02 10:53:17][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Vérification manuelle après échec create_directories: exists() retour 1, ec_check.message : 'Success'
[2025-05-02 10:53:17][INFO] Wallet::ensureWalletsDirectoryExists INFO: Répertoire '../src/data/wallets' existe bien malgré l'échec bizarre de create_directories. Considéré comme succès pour la suite.
[2025-05-02 10:53:17][DEBUG] Wallet Lecture du fichier portefeuille : ../src/data/wallets/Client1.wallet
[2025-05-02 10:53:17][INFO] Wallet Portefeuille (Client1) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-02 10:53:17][INFO] Wallet Portefeuille chargé avec succès pour client ID: Client1 depuis ../src/data/wallets/Client1.wallet
[2025-05-02 10:53:17][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Objet ClientSession créé pour Client ID: 'Client1'. Socket FD: 5
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 10:53:17][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 10:53:17][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 10:53:17][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 10:53:17][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 10:53:17][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 10:53:17][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 10:53:20][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 10:53:20][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 10:53:20][INFO] ClientSession INFO : Commande SHOW WALLET reçue pour client Client1
[2025-05-02 10:53:20][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: BALANCE USD: 10000.0000000000, SRD-BTC: 0.0000000000
...
[2025-05-02 10:53:20][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 10:53:23][DEBUG] ClientSession DEBUG : Reçu 5 octets. Buffer d'accumulation: 5 octets.
[2025-05-02 10:53:23][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'QUIT'
[2025-05-02 10:53:23][INFO] ClientSession INFO : Commande QUIT reçue pour client Client1. Signalement de l'arrêt de la session.
[2025-05-02 10:53:23][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: OK: Disconnecting.
...
[2025-05-02 10:53:23][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'QUIT'
[2025-05-02 10:53:23][INFO] ClientSession INFO : Sortie de la boucle de session pour client Client1. Raison: running=0, client_connected=1
[2025-05-02 10:53:25][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 10:53:25][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 10:53:25][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 10:53:25][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 10:53:25][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 10:53:25][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 10:53:25][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 10:53:25][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 10:53:25][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 10:53:25][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 10:53:25][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 10:53:25][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 10:53:25][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 10:53:25][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 10:53:25][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 10:53:25][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 10:53:25][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 10:53:25][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 10:53:25][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 10:53:25][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 10
[2025-05-02 10:53:25][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 10
[2025-05-02 10:53:25][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 10:53:25][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 10:53:25][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 10:53:25][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 10
[2025-05-02 10:53:25][INFO] ServerConnection::closeConnection INFO : Socket FD: 10 fermé.
[2025-05-02 10:53:25][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 10:53:25][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 10:53:25][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 10:53:28][INFO] Global Nouveau prix SRD-BTC simulé : 97717.0453720345
[2025-05-02 10:53:43][INFO] Global Nouveau prix SRD-BTC simulé : 96755.6175855985
[2025-05-02 10:53:58][INFO] Global Nouveau prix SRD-BTC simulé : 98388.4599433580
[2025-05-02 10:54:13][INFO] Global Nouveau prix SRD-BTC simulé : 96887.1203192451
[2025-05-02 10:54:28][INFO] Global Nouveau prix SRD-BTC simulé : 96136.9923121665
[2025-05-02 10:54:43][INFO] Global Nouveau prix SRD-BTC simulé : 98580.9969449539
[2025-05-02 10:54:58][INFO] Global Nouveau prix SRD-BTC simulé : 96726.2882519401
[2025-05-02 10:55:13][INFO] Global Nouveau prix SRD-BTC simulé : 98746.6071023339
[2025-05-02 10:55:28][INFO] Global Nouveau prix SRD-BTC simulé : 96229.3847364575
[2025-05-02 10:55:43][INFO] Global Nouveau prix SRD-BTC simulé : 97224.6179054184
[2025-05-02 10:55:58][INFO] Global Nouveau prix SRD-BTC simulé : 94376.0128099685
[2025-05-02 10:56:13][INFO] Global Nouveau prix SRD-BTC simulé : 96979.6018549033
[2025-05-02 10:56:28][INFO] Global Nouveau prix SRD-BTC simulé : 97627.7427491624
[2025-05-02 10:56:43][INFO] Global Nouveau prix SRD-BTC simulé : 95251.4725516649
[2025-05-02 10:56:58][INFO] Global Nouveau prix SRD-BTC simulé : 97233.5655092653
[2025-05-02 10:57:14][INFO] Global Nouveau prix SRD-BTC simulé : 97131.8490505442
[2025-05-02 10:57:29][INFO] Global Nouveau prix SRD-BTC simulé : 97765.7169989329
[2025-05-02 10:57:44][INFO] Global Nouveau prix SRD-BTC simulé : 96260.8224604818
[2025-05-02 10:57:59][INFO] Global Nouveau prix SRD-BTC simulé : 94773.9613391654
--- Début du log : 1746176587 ---
[2025-05-02 11:03:07][DEBUG] TransactionQueue créée.
[2025-05-02 11:03:07][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 11:03:07][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 11:03:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 11:03:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 11:03:07][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 11:03:07][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 11:03:07][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 11:03:07][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 11:03:07][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 11:03:07][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 11:03:07][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:03:07][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 3 entrées chargées depuis users.txt
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 11:03:07][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 11:03:07][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 11:03:07][INFO] Global Thread de génération de prix initié.
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 11:03:07][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 11:03:07][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 11:03:07][INFO] Global Thread de génération de prix démarré.
[2025-05-02 11:03:07][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 11:03:07][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 11:03:07][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 11:03:07][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 11:03:07][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 11:03:07][INFO] Global Nouveau prix SRD-BTC simulé : 95083.2230802753
[2025-05-02 11:03:12][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 11:03:12][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 11:03:12][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:03:12][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:03:12][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:03:12][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 11:03:12][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 11:03:12][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 6
[2025-05-02 11:03:12][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 11:03:12][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:03:12][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 11:03:12][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 11:03:12][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 11:03:12][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:03:12][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:03:12][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:03:12][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:03:12][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:03:12][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 6
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1 (sous lock)...
[2025-05-02 11:03:12][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 11:03:12][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 11:03:12][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 11:03:12][WARNING] Wallet::ensureWalletsDirectoryExists WARNING: create_directories retourné false MAIS ec vide. Comportement inhabituel. Chemin: '../src/data/wallets'.
[2025-05-02 11:03:12][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Vérification manuelle après échec create_directories: exists() retour 1, ec_check.message : 'Success'
[2025-05-02 11:03:12][INFO] Wallet::ensureWalletsDirectoryExists INFO: Répertoire '../src/data/wallets' existe bien malgré l'échec bizarre de create_directories. Considéré comme succès pour la suite.
[2025-05-02 11:03:12][DEBUG] Wallet Lecture du fichier portefeuille : ../src/data/wallets/Client1.wallet
[2025-05-02 11:03:12][INFO] Wallet Portefeuille (Client1) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-02 11:03:12][INFO] Wallet Portefeuille chargé avec succès pour client ID: Client1 depuis ../src/data/wallets/Client1.wallet
[2025-05-02 11:03:12][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1 (sous lock).
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Authentification réussie pour client ID: 'Client1'. Envoi réponse AUTH SUCCESS.
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession pour client ID: Client1...
[2025-05-02 11:03:12][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 11:03:12][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 11:03:12][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 11:03:12][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 11:03:12][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 11:03:12][WARNING] ClientSession WARNING : Impossible de démarrer la session pour client Client1 (déjà en cours ou client déconnecté)
[2025-05-02 11:03:12][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:03:16][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 11:03:16][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:03:16][INFO] ClientSession INFO : Commande SHOW WALLET reçue pour client Client1
[2025-05-02 11:03:16][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: BALANCE USD: 10000.0000000000, SRD-BTC: 0.0000000000
...
[2025-05-02 11:03:16][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:03:22][INFO] Global Nouveau prix SRD-BTC simulé : 95714.3487220941
[2025-05-02 11:03:32][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 11:03:32][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:03:32][INFO] ClientSession INFO : Commande SHOW WALLET reçue pour client Client1
[2025-05-02 11:03:32][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: BALANCE USD: 10000.0000000000, SRD-BTC: 0.0000000000
...
[2025-05-02 11:03:32][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:03:37][DEBUG] ClientSession DEBUG : Reçu 5 octets. Buffer d'accumulation: 5 octets.
[2025-05-02 11:03:37][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:03:37][INFO] ClientSession INFO : Commande QUIT reçue pour client Client1. Signalement de l'arrêt de la session.
[2025-05-02 11:03:37][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: OK: Disconnecting.
...
[2025-05-02 11:03:37][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:03:37][INFO] ClientSession INFO : Sortie de la boucle de session pour client Client1. Raison: running=0, client_connected=1
[2025-05-02 11:03:38][INFO] Global Nouveau prix SRD-BTC simulé : 99835.6673302064
[2025-05-02 11:03:39][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 11:03:39][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:03:39][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:03:39][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:03:39][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:03:39][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 11:03:39][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 11:03:39][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 11:03:39][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:03:39][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:03:39][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1
'
[2025-05-02 11:03:39][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 11:03:39][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:03:39][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:03:39][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:03:39][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:03:39][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:03:39][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification réussie (utilisateur existant) pour ID: 'Client1'. Envoi réponse AUTH SUCCESS au client.
[2025-05-02 11:03:39][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 11:03:39][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 10
[2025-05-02 11:03:39][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 10
[2025-05-02 11:03:39][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 11:03:39][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 11:03:39][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 11:03:39][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 10
[2025-05-02 11:03:39][INFO] ServerConnection::closeConnection INFO : Socket FD: 10 fermé.
[2025-05-02 11:03:39][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 11:03:39][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 11:03:39][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 11:03:53][INFO] Global Nouveau prix SRD-BTC simulé : 96270.7348896791
--- Début du log : 1746177427 ---
[2025-05-02 11:17:07][DEBUG] TransactionQueue créée.
[2025-05-02 11:17:07][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 11:17:07][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 11:17:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 11:17:07][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 11:17:07][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 11:17:07][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 11:17:07][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 11:17:07][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 11:17:07][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 11:17:07][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 11:17:07][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:17:07][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 3 entrées chargées depuis users.txt
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 11:17:07][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 11:17:07][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 11:17:07][INFO] Global Thread de génération de prix initié.
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 11:17:07][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 11:17:07][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 11:17:07][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 11:17:07][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 11:17:07][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 11:17:07][INFO] Global Thread de génération de prix démarré.
[2025-05-02 11:17:07][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 11:17:07][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 11:17:07][INFO] Global Nouveau prix SRD-BTC simulé : 97069.4962418221
[2025-05-02 11:17:13][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 6, IP: 10.188.240.101
[2025-05-02 11:17:13][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 6
[2025-05-02 11:17:13][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 6
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:13][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:13][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:17:13][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 11:17:13][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 6
[2025-05-02 11:17:13][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 6
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 6
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 6
[2025-05-02 11:17:13][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (6) et SSL existants.
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 6
[2025-05-02 11:17:13][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:17:13][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 6
[2025-05-02 11:17:13][DEBUG] ServerConnection DEBUG : Reçu 24 octets pour receiveLine sur socket FD: 6. Buffer accumulation size: 24
[2025-05-02 11:17:13][DEBUG] ServerConnection DEBUG : Ligne complète lue pour socket FD: 6. Ligne: 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 6 : 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 6
[2025-05-02 11:17:13][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:17:13][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:17:13][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:17:13][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:17:13][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:17:13][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification terminée avec succès pour ID: 'Client1'. Résultat: SUCCESS. Socket FD: 6
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 6
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1 (sous lock)...
[2025-05-02 11:17:13][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 11:17:13][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 11:17:13][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 11:17:13][WARNING] Wallet::ensureWalletsDirectoryExists WARNING: create_directories retourné false MAIS ec vide. Comportement inhabituel. Chemin: '../src/data/wallets'.
[2025-05-02 11:17:13][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Vérification manuelle après échec create_directories: exists() retour 1, ec_check.message : 'Success'
[2025-05-02 11:17:13][INFO] Wallet::ensureWalletsDirectoryExists INFO: Répertoire '../src/data/wallets' existe bien malgré l'échec bizarre de create_directories. Considéré comme succès pour la suite.
[2025-05-02 11:17:13][DEBUG] Wallet Lecture du fichier portefeuille : ../src/data/wallets/Client1.wallet
[2025-05-02 11:17:13][INFO] Wallet Portefeuille (Client1) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-02 11:17:13][INFO] Wallet Portefeuille chargé avec succès pour client ID: Client1 depuis ../src/data/wallets/Client1.wallet
[2025-05-02 11:17:13][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1 (sous lock).
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Authentification réussie pour client ID: 'Client1'. Envoi réponse AUTH SUCCESS.
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession pour client ID: Client1...
[2025-05-02 11:17:13][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 11:17:13][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 11:17:13][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 11:17:13][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 11:17:13][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 11:17:13][WARNING] ClientSession WARNING : Impossible de démarrer la session pour client Client1 (déjà en cours ou client déconnecté)
[2025-05-02 11:17:13][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:17:22][INFO] Global Nouveau prix SRD-BTC simulé : 99456.3749390404
[2025-05-02 11:17:27][DEBUG] ClientSession DEBUG : Reçu 12 octets. Buffer d'accumulation: 12 octets.
[2025-05-02 11:17:27][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:17:27][INFO] ClientSession INFO : Commande SHOW WALLET reçue pour client Client1
[2025-05-02 11:17:27][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: BALANCE USD: 10000.0000000000, SRD-BTC: 0.0000000000
...
[2025-05-02 11:17:27][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'SHOW WALLET'
[2025-05-02 11:17:30][DEBUG] ClientSession DEBUG : Reçu 5 octets. Buffer d'accumulation: 5 octets.
[2025-05-02 11:17:30][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:17:30][INFO] ClientSession INFO : Commande QUIT reçue pour client Client1. Signalement de l'arrêt de la session.
[2025-05-02 11:17:30][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: OK: Disconnecting.
...
[2025-05-02 11:17:30][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:17:30][INFO] ClientSession INFO : Sortie de la boucle de session pour client Client1. Raison: running=0, client_connected=1
[2025-05-02 11:17:34][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 11:17:34][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:34][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:17:34][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:17:34][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:17:34][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 11:17:34][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 11:17:34][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 11:17:34][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:17:34][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:17:34][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] ServerConnection DEBUG : Reçu 24 octets pour receiveLine sur socket FD: 10. Buffer accumulation size: 24
[2025-05-02 11:17:34][DEBUG] ServerConnection DEBUG : Ligne complète lue pour socket FD: 10. Ligne: 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:34][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:34][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 11:17:34][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:17:34][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:17:34][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:17:34][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:17:34][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:17:34][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification terminée avec succès pour ID: 'Client1'. Résultat: SUCCESS. Socket FD: 10
[2025-05-02 11:17:34][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 11:17:34][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 10
[2025-05-02 11:17:34][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 10
[2025-05-02 11:17:34][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 11:17:34][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 11:17:34][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 11:17:34][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 10
[2025-05-02 11:17:34][INFO] ServerConnection::closeConnection INFO : Socket FD: 10 fermé.
[2025-05-02 11:17:34][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 11:17:34][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 11:17:34][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 11:17:37][INFO] Global Nouveau prix SRD-BTC simulé : 95822.4928977401
[2025-05-02 11:17:41][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 11, IP: 10.188.240.101
[2025-05-02 11:17:41][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:41][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:17:41][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 11:17:41][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 11
[2025-05-02 11:17:41][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 11
[2025-05-02 11:17:41][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 11
[2025-05-02 11:17:41][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (11) et SSL existants.
[2025-05-02 11:17:41][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:17:41][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:17:41][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] ServerConnection DEBUG : Reçu 24 octets pour receiveLine sur socket FD: 11. Buffer accumulation size: 24
[2025-05-02 11:17:41][DEBUG] ServerConnection DEBUG : Ligne complète lue pour socket FD: 11. Ligne: 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:41][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 11 : 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:41][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 11
[2025-05-02 11:17:41][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:17:41][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:17:41][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:17:41][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:17:41][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:17:41][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification terminée avec succès pour ID: 'Client1'. Résultat: SUCCESS. Socket FD: 11
[2025-05-02 11:17:41][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 11
[2025-05-02 11:17:41][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 11
[2025-05-02 11:17:41][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 11
[2025-05-02 11:17:41][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 11:17:41][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 11:17:41][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 11:17:41][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 11
[2025-05-02 11:17:41][INFO] ServerConnection::closeConnection INFO : Socket FD: 11 fermé.
[2025-05-02 11:17:41][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 11:17:41][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 11:17:41][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 11:17:52][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 11:17:52][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:17:52][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:17:52][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:17:52][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:17:52][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 11:17:52][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 11:17:52][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 11:17:52][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:17:52][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:17:52][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] ServerConnection DEBUG : Reçu 24 octets pour receiveLine sur socket FD: 10. Buffer accumulation size: 24
[2025-05-02 11:17:52][DEBUG] ServerConnection DEBUG : Ligne complète lue pour socket FD: 10. Ligne: 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:17:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 11:17:52][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:17:52][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:17:52][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:17:52][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:17:52][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:17:52][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification terminée avec succès pour ID: 'Client1'. Résultat: SUCCESS. Socket FD: 10
[2025-05-02 11:17:52][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 11:17:52][WARNING] Server::HandleClient WARNING : Connexion refusée. Une session pour client ID: 'Client1' est déjà active. Socket FD: 10
[2025-05-02 11:17:52][INFO] ServerConnection::closeConnection INFO : Fermeture de la connexion pour socket FD: 10
[2025-05-02 11:17:52][DEBUG] OpenSSL Callback: SSL3 alert write:warning:close notify
[2025-05-02 11:17:52][DEBUG] ServerConnection::closeConnection DEBUG : SSL_shutdown étape 1/2 terminée. Tentative étape 2 (peut bloquer).
[2025-05-02 11:17:52][DEBUG] ServerConnection::closeConnection DEBUG : Objet SSL libéré.
[2025-05-02 11:17:52][DEBUG] ServerConnection::closeConnection DEBUG : Fermeture du socket FD: 10
[2025-05-02 11:17:52][INFO] ServerConnection::closeConnection INFO : Socket FD: 10 fermé.
[2025-05-02 11:17:52][DEBUG] ServerConnection::closeConnection DEBUG : Nettoyage de connexion terminé.
[2025-05-02 11:17:52][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur appelé. Socket FD final: -1
[2025-05-02 11:17:52][DEBUG] ServerConnection::~ServerConnection DEBUG : Destructeur terminé.
[2025-05-02 11:17:52][INFO] Global Nouveau prix SRD-BTC simulé : 95183.3124171478
--- Début du log : 1746177635 ---
[2025-05-02 11:20:35][DEBUG] TransactionQueue créée.
[2025-05-02 11:20:35][INFO] Main_Serv INFO : Démarrage du programme serveur (config hardcodée).
[2025-05-02 11:20:35][INFO] Main_Serv INFO : Configuration chargée (hardcodée). Port: 4433, Cert: ../server.crt, Key: ../server.key, Users: users.txt, Counter: counter.txt, History: ../src/data/global_transactions.csv, Wallets Dir: ../src/data/wallets/
[2025-05-02 11:20:35][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL...
[2025-05-02 11:20:35][DEBUG] Main_Serv DEBUG : Initialisation globale OpenSSL terminée.
[2025-05-02 11:20:35][INFO] Server::Server INFO : Objet Server créé avec port 4433 et chemins de configuration.
[2025-05-02 11:20:35][INFO] Main_Serv INFO : Objet Server créé. Démarrage...
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Démarrage du serveur sur le port 4433...
[2025-05-02 11:20:35][DEBUG] Server::InitServerCTX DEBUG : Initialisation du contexte SSL serveur...
[2025-05-02 11:20:35][DEBUG] Server::InitServerCTX DEBUG : Contexte SSL serveur créé.
[2025-05-02 11:20:35][DEBUG] Server::InitServerCTX DEBUG : Certificat serveur chargé : ../server.crt
[2025-05-02 11:20:35][DEBUG] Server::InitServerCTX DEBUG : Clé privée serveur chargée : ../server.key
[2025-05-02 11:20:35][INFO] Server::InitServerCTX INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Contexte SSL serveur initialisé avec succès.
[2025-05-02 11:20:35][INFO] Server::LoadUsersInternal INFO : Chargement utilisateurs terminé. 3 entrées chargées depuis users.txt
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Chargement des utilisateurs terminé (ou fichier non trouvé).
[2025-05-02 11:20:35][INFO] Transaction::loadCounter Fichier compteur vide ou contenant 0. Compteur démarrera à 0.
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Chargement du compteur de transactions terminé.
[2025-05-02 11:20:35][INFO] Global Demande de démarrage du thread de génération de prix.
[2025-05-02 11:20:35][INFO] Global Thread de génération de prix initié.
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Thread de génération des prix SRD-BTC démarré (module Global).
[2025-05-02 11:20:35][INFO] TransactionQueue::start Thread de traitement démarré.
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Thread de traitement de la TransactionQueue démarré.
[2025-05-02 11:20:35][INFO] Global Thread de génération de prix démarré.
[2025-05-02 11:20:35][INFO] Global Fichier de log des prix '../src/data/srd_btc_values.csv' ouvert en mode append.
[2025-05-02 11:20:35][INFO] TransactionQueue::process Thread de traitement en cours...
[2025-05-02 11:20:35][DEBUG] Server::StartServer DEBUG : Socket serveur créé avec FD: 4
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Socket serveur lié à l'adresse et au port 4433
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Serveur en écoute sur le port 4433
[2025-05-02 11:20:35][INFO] Server::StartServer INFO : Thread d'acceptation des connexions démarré.
[2025-05-02 11:20:35][DEBUG] Server::StartServer DEBUG : Attente de la fin du thread d'acceptation...
[2025-05-02 11:20:35][INFO] Server::AcceptLoop INFO : Thread démarré. En attente de connexions...
[2025-05-02 11:20:35][INFO] Global Nouveau prix SRD-BTC simulé : 97608.8641072135
[2025-05-02 11:20:40][INFO] Server::AcceptLoop INFO : Nouvelle connexion acceptée. Socket FD: 10, IP: 10.188.240.101
[2025-05-02 11:20:40][DEBUG] Server::AcceptSSLConnection DEBUG : Tentative handshake SSL pour socket FD: 10
[2025-05-02 11:20:40][DEBUG] Server::AcceptSSLConnection DEBUG : Objet SSL créé pour socket FD: 10
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: Handshake before SSL initialization START
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:before SSL initialization
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read client hello
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write server hello
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write change cipher spec
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write encrypted extensions
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write certificate
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:TLSv1.3 write server certificate verify
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write finished
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:TLSv1.3 early data
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS read finished
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: Handshake SSLv3/TLS write session ticket DONE
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:20:40][DEBUG] OpenSSL Callback: undefined:SSLv3/TLS write session ticket
[2025-05-02 11:20:40][ERROR] OpenSSL Callback: SSL_CB_ERROR - SSL negotiation finished successfully
[2025-05-02 11:20:40][INFO] Server::AcceptSSLConnection INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:20:40][INFO] Server::AcceptLoop INFO : Handshake SSL réussi pour socket FD: 10
[2025-05-02 11:20:40][INFO] Server::AcceptLoop INFO : Thread gestion client détaché pour socket FD: 10
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Thread démarré pour socket FD: 10
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Création de l'objet ServerConnection pour socket FD: 10
[2025-05-02 11:20:40][INFO] ServerConnection::ServerConnection INFO : Objet créé avec socket (10) et SSL existants.
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Objet ServerConnection créé et connecté pour socket FD: 10
[2025-05-02 11:20:40][DEBUG] ClientAuthenticator::ClientAuthenticator DEBUG : Objet ClientAuthenticator créé.
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Lancement du processus AuthenticateClient...
[2025-05-02 11:20:40][INFO] ClientAuthenticator::AuthenticateClient INFO : Démarrage authentification pour socket FD: 10
[2025-05-02 11:20:40][DEBUG] ServerConnection DEBUG : Reçu 24 octets pour receiveLine sur socket FD: 10. Buffer accumulation size: 24
[2025-05-02 11:20:40][DEBUG] ServerConnection DEBUG : Ligne complète lue pour socket FD: 10. Ligne: 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:20:40][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Reçu message d'auth de socket FD 10 : 'ID:Client1,TOKEN:Token1'
[2025-05-02 11:20:40][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Parsing réussi. ID: 'Client1', Mot de passe: '[CACHÉ]'. Socket FD: 10
[2025-05-02 11:20:40][DEBUG] ClientAuthenticator::AuthenticateClient DEBUG : Demande au Server de traiter la requête d'auth pour ID: Client1...
[2025-05-02 11:20:40][INFO] Server::processAuthRequest INFO : Tentative auth/enregistrement pour ID: 'Client1'...
[2025-05-02 11:20:40][DEBUG] Server::processAuthRequest DEBUG : ID existant trouvé : 'Client1'. Vérification du mot de passe...
[2025-05-02 11:20:40][WARNING] SecurityUtils WARNING : VerifyPasswordSecure est un placeholder. REMPLACER PAR UNE VRAIE VÉRIFICATION DE HASH SÉCURISÉ !
[2025-05-02 11:20:40][INFO] Server::processAuthRequest INFO : Authentification réussie pour ID existant : 'Client1'.
[2025-05-02 11:20:40][INFO] ClientAuthenticator::AuthenticateClient INFO : Authentification terminée avec succès pour ID: 'Client1'. Résultat: SUCCESS. Socket FD: 10
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Authentification/enregistrement réussi pour client ID: 'Client1' (SUCCESS). Socket FD: 10
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Lancement de la création de ClientSession pour client ID: Client1 (sous lock)...
[2025-05-02 11:20:40][INFO] ClientSession INFO : Initialisation pour client Client1
[2025-05-02 11:20:40][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Chemin répertoire à vérifier/créer : ../src/data/wallets
[2025-05-02 11:20:40][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: create_directories retour : 0, ec.value : 0, ec.message : 'Success', errno : 0, strerror(errno) : 'Success'
[2025-05-02 11:20:40][WARNING] Wallet::ensureWalletsDirectoryExists WARNING: create_directories retourné false MAIS ec vide. Comportement inhabituel. Chemin: '../src/data/wallets'.
[2025-05-02 11:20:40][DEBUG] Wallet::ensureWalletsDirectoryExists DEBUG: Vérification manuelle après échec create_directories: exists() retour 1, ec_check.message : 'Success'
[2025-05-02 11:20:40][INFO] Wallet::ensureWalletsDirectoryExists INFO: Répertoire '../src/data/wallets' existe bien malgré l'échec bizarre de create_directories. Considéré comme succès pour la suite.
[2025-05-02 11:20:40][DEBUG] Wallet Lecture du fichier portefeuille : ../src/data/wallets/Client1.wallet
[2025-05-02 11:20:40][INFO] Wallet Portefeuille (Client1) chargé avec succès : USD=10000.0000000000, SRD-BTC=0.0000000000, Transactions=0
[2025-05-02 11:20:40][INFO] Wallet Portefeuille chargé avec succès pour client ID: Client1 depuis ../src/data/wallets/Client1.wallet
[2025-05-02 11:20:40][DEBUG] Wallet Objet Wallet créé pour client ID: Client1. Chemin du fichier: ../src/data/wallets/Client1.wallet
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1 (sous lock).
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Authentification réussie pour client ID: 'Client1'. Envoi réponse AUTH SUCCESS.
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession pour client ID: Client1...
[2025-05-02 11:20:40][INFO] ClientSession INFO : Démarrage du thread de session pour client Client1
[2025-05-02 11:20:40][INFO] ClientSession INFO : Thread de session démarré et joignable pour client Client1
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Ajout de la session à activeSessions...
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Session enregistrée pour client ID: Client1. Total sessions actives: 1.
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Enregistrement de la session auprès de la TransactionQueue...
[2025-05-02 11:20:40][INFO] TransactionQueue::registerSession Session enregistrée pour client ID: Client1
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : ClientSession pour client ID: Client1 enregistrée auprès de la TransactionQueue.
[2025-05-02 11:20:40][DEBUG] Server::HandleClient DEBUG : Démarrage du thread ClientSession...
[2025-05-02 11:20:40][WARNING] ClientSession WARNING : Impossible de démarrer la session pour client Client1 (déjà en cours ou client déconnecté)
[2025-05-02 11:20:40][INFO] Server::HandleClient INFO : Thread ClientSession démarré pour client ID: Client1. Le thread HandleClient va se terminer normalement.
[2025-05-02 11:20:40][INFO] ClientSession INFO : Thread de session démarré pour client Client1
[2025-05-02 11:20:44][DEBUG] ClientSession DEBUG : Reçu 10 octets. Buffer d'accumulation: 10 octets.
[2025-05-02 11:20:44][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'GET PRICE'
[2025-05-02 11:20:44][WARNING] ClientSession WARNING : Commande inconnue reçue pour client Client1 : 'GET PRICE'
[2025-05-02 11:20:44][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: ERROR: Unknown command 'GET PRICE'. Use SHOW WALLET, SHOW TRANSACTIONS, GET_PRICE <symbol> or QUIT.
...
[2025-05-02 11:20:44][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'GET PRICE'
[2025-05-02 11:20:50][INFO] Global Nouveau prix SRD-BTC simulé : 98057.8044368996
[2025-05-02 11:20:52][DEBUG] ClientSession DEBUG : Reçu 10 octets. Buffer d'accumulation: 10 octets.
[2025-05-02 11:20:52][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'GET_PRICE'
[2025-05-02 11:20:52][WARNING] ClientSession WARNING : Symbole manquant pour commande GET_PRICE pour client Client1
[2025-05-02 11:20:52][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: ERROR: Missing symbol for GET_PRICE. Use GET_PRICE <symbol>.
...
[2025-05-02 11:20:52][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'GET_PRICE'
[2025-05-02 11:20:55][DEBUG] ClientSession DEBUG : Reçu 9 octets. Buffer d'accumulation: 9 octets.
[2025-05-02 11:20:55][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'GETPRICE'
[2025-05-02 11:20:55][WARNING] ClientSession WARNING : Commande inconnue reçue pour client Client1 : 'GETPRICE'
[2025-05-02 11:20:55][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: ERROR: Unknown command 'GETPRICE'. Use SHOW WALLET, SHOW TRANSACTIONS, GET_PRICE <symbol> or QUIT.
...
[2025-05-02 11:20:55][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'GETPRICE'
[2025-05-02 11:21:05][INFO] Global Nouveau prix SRD-BTC simulé : 96249.3413949136
[2025-05-02 11:21:07][DEBUG] ClientSession DEBUG : Reçu 18 octets. Buffer d'accumulation: 18 octets.
[2025-05-02 11:21:07][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'GET_PRICE SRD-BTC'
[2025-05-02 11:21:07][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: PRICE SRD-BTC 96249.34139491
...
[2025-05-02 11:21:07][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'GET_PRICE SRD-BTC'
[2025-05-02 11:21:20][INFO] Global Nouveau prix SRD-BTC simulé : 97093.6230443623
[2025-05-02 11:21:23][DEBUG] ClientSession DEBUG : Reçu 5 octets. Buffer d'accumulation: 5 octets.
[2025-05-02 11:21:23][INFO] ClientSession INFO : Début traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:21:23][INFO] ClientSession INFO : Commande QUIT reçue pour client Client1. Signalement de l'arrêt de la session.
[2025-05-02 11:21:23][DEBUG] ClientSession DEBUG : Réponse envoyée à Client1: OK: Disconnecting.
...
[2025-05-02 11:21:23][INFO] ClientSession INFO : Fin traitement commande pour client Client1 : 'QUIT'
[2025-05-02 11:21:23][INFO] ClientSession INFO : Sortie de la boucle de session pour client Client1. Raison: running=0, client_connected=1
